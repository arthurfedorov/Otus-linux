# Пользователи и группы. Аутентификация и авторизация

## TO-DO

- [x] Основное задание
- [x] Задание со *

## Домашнее задание

- Запретить всем пользователям, кроме группы admin логин в выходные (суббота и воскресенье), без учета праздников

- Со * - дать конкретному пользователю права работать с докером и возможность рестартить докер сервис

---

Для проверки выполнения домашнего задания, необходимо склонировать репозиторий, перейти в соответствующую папку PAM и командой **vagrant up** поднять виртуальную машину

> [!Важно]
> В случае, если Ansible установлен в virtualenv (как у меня), необходимо активировать виртуальное окружение.

После того как Ansible запровижинит все, можно логиниться под учетками *day* (аутентификация доступна каждый день с 08:00 - 20:00), *night* (аутентификация доступна каждый день с 20:00 - 08:00) , *friday* (аутентификация доступна всю пятницу).

> [!Важно]
> Необходимо удалить ключ локальной машины Vagrant из *~/.ssh/known_hosts*. Не смог побороть эту проблему, каждый раз при инициализации новой машины, приходится удалять ключ.

Запуск docker.service доступен для учетной записи *day*. Не удалось найти более красивого решения, кроме как через PolKit дать доступ на запуск systemd служб. Решение запуска только службы docker, которое нашел в Интернете не взлетело по каким-то причинам.

```javascript
polkit.addRule(function(action, subject) {
    if (action.id == "org.freedesktop.systemd1.manage-units" &&
    action.lookup("unit") == "docker.service" &&
    subject.user == "day") {
        return polkit.Result.YES;
    }
});
```
