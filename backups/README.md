# Резервное копирование

## TO-DO

- [x] Основное задание
- [x] Задание со *
- [ ] Переписать playbook на roles, с использованием нормальной структуры проекта - vars, inventory, templates и т.п
- [ ] Использовать ansible vault для хранения паролей

## Домашнее задание

Настроить стенд Vagrant с двумя виртуальными машинами server и client. Настроить политику бэкапа директории /etc с клиента: 

- Полный бэкап - раз в день

- Инкрементальный - каждые 10 минут

- Дифференциальный - каждые 30 минут

Запустить систему на два часа. Для сдачи ДЗ приложить list jobs, list files jobid=<id> и сами конфиги bacula-*

---

Для выполнения домашнего задания был выбран borgbackup, в связи с этим, формулировка задания мало актуальна для данного решения. Первый бэкап создается сразу после запуска playbook и далее, Раз в 10 минут по cron снимается инкрементальный бэкап.

Для проверки домашнего задания, необходимо поднять машины с помощью *vagrant up*. После того, как они поднимутся, необходимо запустить playbook с необходимым уровнем verbose.

```bash
ansible-playbook playbook.yml -vvv
```
Я не смог нормально запустить провиженинг двух Vagrant машин в Vagrantfile, ansible ругался на то, что машина еще не поднята, а как заставить запускать провиженинг только после поднятия всех машин, я не догадался. Вероятно если все tasks не в одном playbook держать, а создать правильную структуру проекта, ошибки не будет. 
Очень нуждаюсь в помощи по Ansbile.